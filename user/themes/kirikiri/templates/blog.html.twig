{% extends 'partials/base.html.twig' %}

{% block content %}
    {% if uri.param('tag') %}
        <h1 class="page-title text-center">Teema: {{ uri.param('tag') }}</h1>
    {% endif %}
    {% if uri.param('author') %}
        <h1 class="page-title text-center">Autor: {{ uri.param('author') }}</h1>
    {% endif %}

    <div class="post-grid">
        {% set posts = page.collection() %}
        {% for post in posts %}
            <article class="card">
                {% if post.header.image %}
                    <a href="{{ post.url }}" class="card-image-link">
                        <img src="{{ post.media[post.header.image].url }}" alt="{{ post.title }}" class="card-image">
                    </a>
                {% endif %}
                
                <div class="card-content">
                    <div class="card-category">
                        {% for tag in post.taxonomy.tag %}
                            <a href="{{ base_url }}/tag:{{ tag }}">{{ tag }}</a>{% if not loop.last %}, {% endif %}
                        {% else %}
                            Artikkel
                        {% endfor %}
                    </div>
                    <h3 class="card-title">
                        <a href="{{ post.url }}">{{ post.title }}</a>
                    </h3>
                    <div class="card-excerpt">
                        {{ post.summary|striptags }}
                    </div>
                    <div class="card-footer">
                        {% set months = ["jaanuar", "veebruar", "m√§rts", "aprill", "mai", "juuni", "juuli", "august", "september", "oktoober", "november", "detsember"] %}
                        <span class="card-date">{{ post.date|date("j.") }} {{ months[post.date|date("n") - 1] }} {{ post.date|date("Y") }}</span>
                        {% if post.header.author %}
                            <span class="card-author">
                                <a href="{{ base_url }}/author:{{ post.header.author|url_encode }}">{{ post.header.author }}</a>
                            </span>
                        {% endif %}
                    </div>
                </div>
            </article>
        {% endfor %}
    </div>
{% endblock %}
